<!doctype html>
<html>
  <head>
    <title>Bus It! - Home</title>
    
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
  </head> 
  <body>

     
   
<!--yellow #ffff4d
    button blue #12377E -->   

  
 <iframe src="http://free.timeanddate.com/clock/i681093j/n179/fn15/fs20/ftb/th2/ta1" frameborder="0" width="169" height="25"></iframe>
 

 <div class="banner">
     <h1>Bus It!</h1>
     <h3>Your one stop for new york public transport information</h3>
 </div>
 
 <div class="nav">
  <ul>
<li class="active"><a href="index.html">Home</a></li>   
<li ><a href="about.html">About Us</a> </li>     
      
      
  </ul>  
        
 </div>
 
<div class="input">
 <form action="">
 <select name="line" value="line">Line</select>
       <!-- <option value="borough">borough</option> --><br>
        <select name="route" value="route">Route
       
    </select><br>
    <input type="submit" value="submit">
</form>
      </div>
   <div class="maps">
       <h1>Google Maps</h1>
       <div id="map"></div>
   </div> 
        
<div class="busing">
    <h1>Busing test</h1>
</div>
  
  <div class="weather">
     <h1>Weather</h1>
      <div id="Updated">
      
      </div>
      <div id="curweath">
      
      </div> 
      <div id="windspeed">
      </div>
      
      <div id="temp">
      
      </div>
      <div id="feelslike">
          
      </div>
  </div>
  
  
    <!-- page structure above this comment code below-->
     
     
     <!--Script for grabbing api's-->  
   <script>
	//bustime GET/eventlistiener
	var urlMBTA = "http://rvccmccs01.raritanval.edu/~scaruso/cisy268/mbta.php?key=A0f4f68f-5ed0-45d8-b0ce-e127971315b1&includePolylines=false&version=2"; //where the api call and key goes
	var dataMBTA;
	var infoMBTA;
      
      
	var urlMTA = "http://rvccmccs01.raritanval.edu/~scaruso/cisy268/mta.php?key=A0f4f68f-5ed0-45d8-b0ce-e127971315b1&includePolylines=false&version=2";
	var dataMTA;
	var infoMTA;
      
      
	var urlMTABC = "http://rvccmccs01.raritanval.edu/~scaruso/cisy268/mtabc.php?key=A0f4f68f-5ed0-45d8-b0ce-e127971315b1&includePolylines=false&version=2";
	var dataMTABC;
	var infoMTABC;
      
    var busInfo = []; //ALL THE THINGS GO HERE!
      
	var weatherCurrent = "http://api.wunderground.com/api/04a13f21c29c4d09/conditions/q/NY/New_York.json";
	var dataCurent;
	var infoCurent;
	
	
	//" + stopLat + ", " + stopLng + ".json"
	var weatherForcast = "http://api.wunderground.com/api/04a13f21c29c4d09/forecast/q/NY/New_York.json";
	var dataForecast;
	
	//XMLHttpRequest Object
	var xhttp = new XMLHttpRequest();
          xhttp.onload = whenLoadedMBTA;
          xhttp.open("GET", urlMBTA);
         // xhttp.overrideMimeType("application/json");
          xhttp.send();
    
    //API Chain #1
    function whenLoadedMBTA() {
        
        dataMBTA = JSON.parse(xhttp.responseText);
        
        xhttp.open("GET", urlMTA);
        xhttp.onload = whenLoadedMTA;
        xhttp.overrideMimeType("application/json");
        xhttp.send();
        
        console.log("MBTA Loaded...");

    }
	
	//API Chain #2
	function whenLoadedMTA() {
		dataMTA = JSON.parse(xhttp.responseText);
		
		//Data processing
        for (var i in dataMTA.data.list) {
        	
        	busInfo[dataMTA.data.list[i].shortName] = dataMTA.data.list[i];
        	
        }
		
		xhttp.open("GET", urlMTABC);
        xhttp.onload = whenLoadedMTABC;
        xhttp.overrideMimeType("application/json");
        xhttp.send();
        
        console.log("MTA Loaded...");

	}    
    
    //API Chain #3
	function whenLoadedMTABC() {
		
		dataMTABC = JSON.parse(xhttp.responseText);
		
		//Data processing
        for (var i in dataMTABC.data.list) {
        	
        	busInfo[dataMTABC.data.list[i].shortName] = dataMTABC.data.list[i];
        	
        }
		
		xhttp.open("GET", weatherCurrent);
        xhttp.onload = whenLoadedCurrent;
        xhttp.overrideMimeType("application/json");
        xhttp.send();
		
		console.log("MTABC Loaded...");
		
	}
      
	var curweath =  document.getElementById("curweath");
	var Updated = document.getElementById("Updated");
	var windspeed = document.getElementById("windspeed");
	//var windLow = document.getElementById("windLow");
	var Temp = document.getElementById("temp");
	
	//API Chain #4
	function whenLoadedCurrent() {
		
		dataCurrent = JSON.parse(xhttp.responseText);
    
		Updated.innerHTML = "Date updated: " + dataCurrent.current_observation.observation_time;
		curweath.innerHTML = "Current Weather: " + dataCurrent.current_observation.weather;
		windspeed.innerHTML = "Current wind speed: " + dataCurrent.current_observation.wind_mph + "MPH with gusts up to " + dataCurrent.current_observation.wind_gust_mph + "MPH";
		Temp.innerHTML = "current temperture: " + dataCurrent.current_observation.temp_f;
		
		console.log("Weather Loaded...");
		
		displayBusses();
		
	}
	
	
	function whenLoadedForecast(){
		dataForecast = 
		JSON.parse(xhttp.responseText);
	}
	
	var line = document.getElementById("line");
	//Final chain link
	function displayBusses() {
	
		for (var i in busInfo) {
		
			//busInfo[i]
            line += '<option value="' +busInfo[i];
		
		}
	
	}
	
	
      </script>

      <script>/*
      var weatherCurrent = "http://api.wunderground.com/api/04a13f21c29c4d09/conditions/q/NY/New_York.json"
      
    
      var data;
      
      var xhttp = new XMLHttpRequest();
          
          xhttp.open("GET",weather);
          xhttp.onload = whenloaded;
          xhttp.send();
          
          var curweath =  document.getElementById("curweath");
          var Updated = document.getElementById("Updated");
          var windspeed = document.getElementById("windspeed");
          //var windLow = document.getElementById("windLow");
          var Temp = document.getElementById("temp")
          var feelslike = document.getElementById("feelslike")
          function whenloaded(){
          
              data = JSON.parse(xhttp.responseText);
              
              Updated.innerHTML = "Date updated: " + data.current_observation.observation_time;
              curweath.innerHTML = "Current Weather: " + data.current_observation.weather;
              windspeed.innerHTML = "Current wind speed: " + data.current_observation.wind_mph + "MPH" + " (" + data.current_observation.wind_kph + "KPH)" + ", with gusts up to " + data.current_observation.wind_gust_mph + "MPH (" + data.current_observation.wind_gust_kph + "KPH)";
              Temp.innerHTML = "Current temperture: " + data.current_observation.temp_f + "F (" + data.current_observation.temp_c + "C)"
              feelslike.innerHTML = "Feels like: " + data.current_observation.feelslike_string;
              
         // Document.getElementById("curweath").innerHTML = data.weather;
         // Document.getElementById("wind").innerHTML = data.wind_mph;
         // Document.getElementById("windgust").innerHTML = data.wind_gust_mph;
         // Document.getElementById("temp").innerHTML = data.temp_f;
         // Document.getElementById("updated").innerHTML = data.observation_time;
              
        }*/
      </script>
      
     <script>
   
   function initMap() {
        var NY = {lat: 40.7128, lng: -73.935242};
        //var stopLat = 
        //var stopLng
        //lat: stopLat, lng:stopLng
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 10,
          center: NY
        });
        var marker = new google.maps.Marker({
          position: NY,
          map: map
        });
      }

      </script> 
 <script> 

</script>


  </body>
  

</html>
